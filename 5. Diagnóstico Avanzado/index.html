
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../4.%20Diagn%C3%B3stico%20Inicial/">
      
      
        <link rel="next" href="../6.%20Aprovisionamiento/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.10">
    
    
      
        <title>5. Diagnóstico Avanzado - st-tools-doc > telemetria-formosa</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.fad675c6.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="purple" data-md-color-accent="orange">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#impresiones-en-modo-testing" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="st-tools-doc &gt; telemetria-formosa" class="md-header__button md-logo" aria-label="st-tools-doc > telemetria-formosa" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            st-tools-doc > telemetria-formosa
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              5. Diagnóstico Avanzado
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="purple" data-md-color-accent="orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="dark-purple" data-md-color-accent="orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="st-tools-doc &gt; telemetria-formosa" class="md-nav__button md-logo" aria-label="st-tools-doc > telemetria-formosa" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    st-tools-doc > telemetria-formosa
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../1.%20Conexi%C3%B3n%20USB%20a%20Gateway/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. Conexión USB a Gateway
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../2.%20Grabaci%C3%B3n%20de%20Firmware/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. Grabación de Firmware
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../3.%20Marcadores%20de%20Progreso/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. Marcadores de Progreso
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../4.%20Diagn%C3%B3stico%20Inicial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. Diagnóstico Inicial
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    5. Diagnóstico Avanzado
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    5. Diagnóstico Avanzado
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#impresiones-en-modo-testing" class="md-nav__link">
    <span class="md-ellipsis">
      Impresiones en modo Testing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#identificando-sintomas" class="md-nav__link">
    <span class="md-ellipsis">
      Identificando síntomas
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Identificando síntomas">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sin-respuesta-del-modem" class="md-nav__link">
    <span class="md-ellipsis">
      Sin respuesta del módem
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-con-tarjeta-sim" class="md-nav__link">
    <span class="md-ellipsis">
      Error con tarjeta SIM
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#problema-con-la-antena-o-senal" class="md-nav__link">
    <span class="md-ellipsis">
      Problema con la antena o señal
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../6.%20Aprovisionamiento/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6. Aprovisionamiento
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../Alta%20de%20claves%20SSH%20en%20GitHub/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Alta de claves SSH en GitHub
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../Habilitar%20servicio%20SSH/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Habilitar servicio SSH
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#impresiones-en-modo-testing" class="md-nav__link">
    <span class="md-ellipsis">
      Impresiones en modo Testing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#identificando-sintomas" class="md-nav__link">
    <span class="md-ellipsis">
      Identificando síntomas
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Identificando síntomas">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sin-respuesta-del-modem" class="md-nav__link">
    <span class="md-ellipsis">
      Sin respuesta del módem
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-con-tarjeta-sim" class="md-nav__link">
    <span class="md-ellipsis">
      Error con tarjeta SIM
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#problema-con-la-antena-o-senal" class="md-nav__link">
    <span class="md-ellipsis">
      Problema con la antena o señal
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>5. Diagnóstico Avanzado</h1>

<h3 id="impresiones-en-modo-testing"><strong>Impresiones en modo Testing</strong><a class="headerlink" href="#impresiones-en-modo-testing" title="Permanent link">&para;</a></h3>
<p>Las impresiones de registro son mensajes que un programa o aplicación emite durante su ejecución para proporcionar información sobre lo que está ocurriendo en su interior. En este documento se desarrollarán los registros del programa de gateway que son útiles para diagnosticar problemas.
Esta aplicación se divide en módulos. Los registros que se van imprimiendo incluyen una etiqueta que declara de qué modulo proviene el mensaje, por ejemplo, si se trata de la comunicación 4G o si es la conexión al servicio de nube. Además, cada línea de registro incluye una marca de tiempo y un indicador de nivel de prioridad. </p>
<div class="highlight"><pre><span></span><code>[Nivel] (Marca de tiempo) Etiqueta: Mensaje
</code></pre></div>
<ul>
<li>
<p><strong>Nivel</strong>: Indica la importancia del mensaje y la cantidad de mensajes.
    0) Sin impresiones
    1) <code>E</code> (ERROR)
    2) <code>W</code> (WARNING)
    3) <code>I</code> (INFO)
    4) <code>D</code> (DEBUG)
    5) <code>V</code> (VERBOSE)
    Mientras más alto sea el nivel, más cantidad de impresiones se van a visualizar.</p>
</li>
<li>
<p><strong>Marca de tiempo</strong>: Muestra cuándo se generó el mensaje, lo que puede ser útil para rastrear eventos en el tiempo. Si el dispositivo se sincronizó, indicara el tiempo UTC, de lo contrario indicará el tiempo desde que el dispositivo inició.</p>
</li>
<li>
<p><strong>Fuente (etiqueta)</strong>: Es una etiqueta que identifica de dónde proviene el mensaje. Esto es útil para saber qué parte de la aplicación generó el mensaje.</p>
</li>
<li>
<p><strong>Mensaje</strong>: Es el contenido del mensaje en sí. Puede proporcionar detalles sobre lo que está ocurriendo, errores detectados o cualquier otra información relevante.</p>
</li>
</ul>
<p>El firmware de testing permite establecer el nivel (0 a 5) para cada etiqueta. En principio todos los módulos imprimirán en nivel 3 <code>INFO</code>, pero puedes cambiar a nivel 0 las etiquetas que desees para dejar de ver las impresiones. para ello:
- Ingresando <code>//[etiqueta],0</code> donde <code>[etiqueta]</code> es el nombre de la etiqueta que deseas deshabilitar.
- Con <code>//*,0</code> deshabilitaras todas las etiquetas.
- Para volver a habilitar una etiqueta ingresa <code>//[etiqueta],3</code></p>
<h3 id="identificando-sintomas"><strong>Identificando síntomas</strong><a class="headerlink" href="#identificando-sintomas" title="Permanent link">&para;</a></h3>
<p>El módulo 4G utilizado es el EC21. Entre los registros que arroja el firmware de testing encontraras algunos con las etiquetas EC21_AT los cuales indican los comandos y respuestas que producen entre el procesador del gateway y el módulo 4G.</p>
<h4 id="sin-respuesta-del-modem"><strong>Sin respuesta del módem</strong><a class="headerlink" href="#sin-respuesta-del-modem" title="Permanent link">&para;</a></h4>
<p>Cuando el procesador no logra comunicarse con el módulo 4G EC21 (módem) observarás las siguientes impresiones.</p>
<p><img alt="3f8d74e7-3f06-40e4-8bfa-6e993ff207cc.png" src="../src/3f8d74e7-3f06-40e4-8bfa-6e993ff207cc.png" /></p>
<p>Se repite el comando AT+CGATT ya que no se recibe respuesta. Esto sucede por un minuto aproximadamente, hasta que el circuito intenta reiniciar el módem y luego espera. </p>
<p><img alt="2c9b769b-4c1a-4e21-aee4-4d5d6edc63e2.png" src="../src/2c9b769b-4c1a-4e21-aee4-4d5d6edc63e2.png" /></p>
<p>Los mensajes <code>timeout to verify RDY</code> y <code>EC21 not reported</code> confirman que se han agotado todas las instancias de comunicación con el modulo EC21.
<strong>Acción: Revisar la conexión del procesador con el módulo 4G (EC21)</strong></p>
<h4 id="error-con-tarjeta-sim"><strong>Error con tarjeta SIM</strong><a class="headerlink" href="#error-con-tarjeta-sim" title="Permanent link">&para;</a></h4>
<p>Cuando se recibe una respuesta de <code>ERROR</code> al comando AT+CGATT entonces es probable que se deba a un inconveniente con la tarjeta SIM que impide que el módem la pueda leer correctamente. No implica que la línea tenga problemas de habilitación, o de saldo disponible, ya que AT+CGATT solo revisa la conexión física con la tarjeta SIM y que se pueda leer correctamente.</p>
<p><img alt="4d2a6948-1db1-4bf2-9822-85fc6e3b5b4a.png" src="../src/4d2a6948-1db1-4bf2-9822-85fc6e3b5b4a.png" /></p>
<p><strong>Acción: Revisar la conexión de la tarjeta SIM con el módulo 4G. También los contactos y el sujetador de la tarjeta SIM</strong></p>
<h4 id="problema-con-la-antena-o-senal"><strong>Problema con la antena o señal</strong><a class="headerlink" href="#problema-con-la-antena-o-senal" title="Permanent link">&para;</a></h4>
<p>Cuando las líneas de comunicación entre el módem, el procesador y tarjeta SIM son correctas, podrás ver que el módulo EC21 responde con <code>RDY</code> para indicar que esta listo para trabajar.</p>
<p><img alt="5ed1c4f0-6676-4b2a-8f36-9520a1df3d3d.png" src="../src/5ed1c4f0-6676-4b2a-8f36-9520a1df3d3d.png" /></p>
<p>Esto puedes verificarlo con la impresión <code>&gt;EC21 ready for work!</code>
Si hubiera problemas con la antena o de señal, es posible que no pueda establecer la conexión con la red 4G para obtener internet. En este caso veras un bucle que repetirá los siguientes mensajes:</p>
<p><img alt="6bcf5f6e-80bf-4de2-af2c-009d6ad8beec.png" src="../src/6bcf5f6e-80bf-4de2-af2c-009d6ad8beec.png" />
<strong>Acción: Probar con otra antena, con otro conector U.FL / IPX a SMA. Verificar la recepción de señal en el área.</strong></p>
<p><strong>NOTA:</strong> Para mas detalles de cómo revisar el hardware de la placa del gateway puedes utilizar <a href="../src/76b3e6a2-7bf8-4c2c-b1c5-8d671c1aef36.pdf">esta referencia</a>.</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.6c14ae12.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
      
    
  </body>
</html>